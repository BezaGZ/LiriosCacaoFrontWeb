<div>
<!--  <div class="hidden md:flex items-center justify-between px-6 py-2 shadow-sm fixed top-0 left-0 right-0 bg-white z-40">-->
  <div class="hidden md:flex items-center justify-between px-6 py-2 shadow-sm sticky top-0 bg-[#FFF8F1] z-40">

    <a class="layout-topbar-logo flex items-center" routerLink="/">
      <img src="assets/img/logo_cafe.png" alt="logo" class="h-18 w-auto object-contain mr-3" />
    </a>

    <div class="flex justify-center items-center gap-4">
      <div class="flex flex-col items-center cursor-pointer
            transition transform hover:scale-110 hover:text-[#452317] "(click)=irInicio()>
        <img src="assets/icons/inicio.svg" alt="inicio"
             class="w-7 h-5 mb-1 transition-transform duration-200" />
        <span class="text-sm">Inicio</span>
      </div>
      <div class="flex flex-col items-center cursor-pointer
            transition transform hover:scale-110 hover:text-[#452317]">
        <img src="assets/icons/chocofruta.svg" alt="chocofrutas" class="w-5 h-5 mb-1" />
        <span class="text-sm">Chocofrutas</span>
      </div>
      <div class="flex flex-col items-center cursor-pointer
            transition transform hover:scale-110 hover:text-[#452317]">
        <img src="assets/icons/helados.svg" alt="helados" class="w-5 h-5 mb-1" />
        <span class="text-sm">Helados</span>
      </div>
      <div class="flex flex-col items-center cursor-pointer
            transition transform hover:scale-110 hover:text-[#452317]">
        <img src="assets/icons/floristeria.svg" alt="Flor" class="w-5 h-5 mb-1" />
        <span class="text-sm">Floristería</span>
      </div>
      <div class="flex flex-col items-center cursor-pointer
            transition transform hover:scale-110 hover:text-[#452317]">
        <img src="assets/icons/eventos.svg" alt="Globos" class="w-5 h-5 mb-1" />
        <span class="text-sm">Eventos</span>
      </div>
    </div>

    <div class="relative flex flex-col items-center cursor-pointer" (click)="showCart()">
      <img src="assets/icons/carrito.svg" alt="Carrito" class="w-5 h-5 mb-1" />
      <span class="text-sm">Carrito</span>

      <span *ngIf="cartItemCount > 0" class="absolute -top-1 -right-2 bg-red-500 text-white text-[10px] font-bold rounded-full px-[6px] py-[2px] leading-none animate-bounce">
    {{ mostrarCantidadCarrito() }}
  </span>
    </div>

  </div>

  <div class="md:hidden fixed bottom-0 left-0 z-50 w-full h-16 bg-white border-t border-gray-200 flex justify-around items-center">

    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
    (click)="irInicio()">
      <img src="assets/icons/inicio.svg" alt="inicio" class="w-7 h-5 mb-1"  />
      <span class="text-xs">Inicio</span>
    </div>
    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
    >
      <img src="assets/icons/chocofruta.svg" alt="chocofrutas" class="w-5 h-5 mb-1" />
      <span class="text-xs">Chocofrutas</span>
    </div>
    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
    >
      <img src="assets/icons/helados.svg" alt="helados"
           class="w-5 h-5 mb-1 transition-transform duration-200" />
      <span class="text-xs">Helados</span>
    </div>
    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
    >
      <img src="assets/icons/floristeria.svg" alt="Flor" class="w-5 h-5 mb-1" />
      <span class="text-xs">Floristería</span>
    </div>
    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
    >
      <img src="assets/icons/eventos.svg" alt="Flor" class="w-5 h-5 mb-1" />
      <span class="text-xs">Eventos</span>
    </div>

    <div
      class="flex flex-col items-center cursor-pointer
         transition transform duration-200
         hover:scale-110 hover:-translate-y-1
         active:scale-110 active:animate-bounce md:active:scale-100 md:active:animate-none"
      (click)="showCart()"
    >
      <img src="assets/icons/carrito.svg" alt="Carrito" class="w-5 h-5 mb-1" />
      <span class="text-xs">Carrito</span>
      <span *ngIf="cartItemCount > 0" class="absolute -top-1 -right-2 bg-red-500 text-white text-[10px] font-bold rounded-full px-[6px] py-[2px] leading-none animate-bounce">
    {{ mostrarCantidadCarrito() }}
  </span>
    </div>

  </div>
  <p-sidebar
    [(visible)]="sidebarVisible"
    (visibleChange)="onSidebarVisibleChange($event)"
    position="right"
    [modal]="true"
    [dismissible]="false"
    [showCloseIcon]="true"
    [baseZIndex]="5000"
    [blockScroll]="false"
    [style]="{ width: '92vw', maxWidth: '420px' }"
  >
    <ng-template pTemplate="header">
      <div class="font-semibold">Tu carrito</div>
    </ng-template>

    <div class="flex flex-col gap-3 max-h-[70vh] overflow-y-auto pr-1">
      <div *ngIf="(cart.items$ | async) as items; else empty">
        <div *ngFor="let it of items" class="flex gap-3 items-center border-b pb-2">
          <img [src]="it.imageUrl" class="w-14 h-14 object-contain rounded border" />
          <div class="flex-1 min-w-0">
            <div class="font-medium text-sm leading-tight line-clamp-2">{{ it.title }}</div>
            <div class="text-xs text-gray-500">Q{{ it.unitPrice | number:'1.2-2' }} c/u</div>
            <div class="mt-1 flex items-center gap-2">
              <button pButton icon="pi pi-minus" size="small" (click)="dec(it)"></button>
              <span class="w-6 text-center font-medium">{{ it.qty }}</span>
              <button pButton icon="pi pi-plus" size="small" (click)="inc(it)"></button>
              <button pButton icon="pi pi-trash" class="p-button-text p-button-danger ml-auto" (click)="remove(it)"></button>
            </div>
          </div>
          <div class="font-bold">Q{{ (it.unitPrice * it.qty) | number:'1.2-2' }}</div>
        </div>
      </div>
      <ng-template #empty>
        <div class="text-center text-sm text-gray-500 py-6">Tu carrito está vacío</div>
      </ng-template>
    </div>

    <p-divider></p-divider>

    <div class="flex flex-col gap-3">
      <!-- Entrega -->
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-4">
          <div class="flex items-center gap-2">
            <p-radioButton
              name="entrega"
              [value]="'domicilio'"
              [(ngModel)]="entrega"
              inputId="entrega-domicilio">
            </p-radioButton>
            <label  class="cursor-pointer">A domicilio</label>
          </div>

          <div class="flex items-center gap-2">
            <p-radioButton
              name="entrega"
              [value]="'local'"
              [(ngModel)]="entrega"
              inputId="entrega-local">
            </p-radioButton>
            <label  class="cursor-pointer">Recoger en local</label>
          </div>
        </div>
      </div>

      <!-- Dirección si es a domicilio -->
      <div *ngIf="entrega === 'domicilio'">
        <label class="block text-sm font-medium mb-1">Dirección de entrega</label>
        <input
          type="text"
          pInputText
          [(ngModel)]="direccion"
          placeholder="Ej: 5a avenida 3-45 zona 1, Esquipulas"
          class="w-full"
        />
        <small class="text-xs text-gray-500">
          Por favor, incluye referencias si es posible.
        </small>
      </div>

      <!-- Método de pago -->
      <div class="flex items-center gap-4">
        <div class="flex items-center gap-4">
          <div class="flex items-center gap-2">
            <p-radioButton
              name="pago"
              [value]="'efectivo'"
              [(ngModel)]="pago"
              inputId="pago-efectivo">
            </p-radioButton>
            <label  class="cursor-pointer">Efectivo</label>
          </div>

          <div class="flex items-center gap-2">
            <p-radioButton
              name="pago"
              [value]="'tarjeta'"
              [(ngModel)]="pago"
              inputId="pago-tarjeta">
            </p-radioButton>
            <label  class="cursor-pointer">Tarjeta</label>
          </div>
        </div>
      </div>

      <!-- Cambio si pago en efectivo -->
      <div *ngIf="pago === 'efectivo'">
        <label class="block text-sm font-medium mb-1">¿Con cuánto pagas? (opcional)</label>
        <p-inputNumber
          [(ngModel)]="cambio"
          mode="decimal"
          [minFractionDigits]="0"
          [maxFractionDigits]="2"
          inputId="cambio"
          [useGrouping]="false"
          placeholder="Ej: 100 o 10.50"
          class="w-full"
        ></p-inputNumber>
        <small class="text-xs text-gray-500">
         Indica el valor del efectivo con el que pagarás para facilitar el cambio.
        </small>
      </div>

      <!-- Resumen -->
      <div class="mt-2 space-y-1 text-sm">
        <div class="flex justify-between"><span>Subtotal</span><span>Q{{ subtotal | number:'1.2-2' }}</span></div>
        <div class="flex justify-between"><span>Envío</span><span>Q{{ deliveryFee | number:'1.2-2' }}</span></div>
        <div class="flex justify-between"><span>Fee app</span><span>Q{{ appFee | number:'1.2-2' }}</span></div>
        <div class="flex justify-between text-base font-bold pt-1 border-t">
          <span>Total</span><span>Q{{ grandTotal | number:'1.2-2' }}</span>
        </div>
      </div>

      <button
        pButton
        label="Enviar pedido por WhatsApp"
        icon="pi pi-whatsapp"
        (click)="checkoutWhatsApp()"
        [disabled]="entrega === 'domicilio' && !direccion.trim()"
      ></button>
    </div>
  </p-sidebar>
</div>
